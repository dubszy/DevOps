version: '3.7'
services:
  artifactory:
    build:
      context: .
      dockerfile: docker/Dockerfile.artifactory
    ports:
      - 8081:8081
    volumes:
      - ./data/persistent/artifactory/access:/artifactory/access
      - ./data/persistent/artifactory/backup:/artifactory/backup
      - ./data/persistent/artifactory/data:/artifactory/data
      - ./data/persistent/artifactory/etc:/artifactory/etc
      - ./data/persistent/artifactory/logs:/artifactory/logs
  etcd:
    build:
      context: .
      dockerfile: docker/Dockerfile.etcd
    ports:
      - 2379:2379
    volumes:
      - ./config:/config
  jenkins:
    build:
      context: .
      dockerfile: docker/Dockerfile.jenkins
    init: true
    ports:
      - 8082:8080
      - 50000:50000
    volumes:
      - ./data/persistent/jenkins:/var/jenkins_home
  redis:
    image: redis:5-alpine
    ports:
      - 6379:6379
  resque:
    build:
      context: .
      dockerfile: docker/Dockerfile.resque
    links:
      - redis
    ports:
      - 5678:5678
